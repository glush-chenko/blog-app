import {makeAutoObservable} from 'mobx';
import {Article} from "../types/Article";

class ArticleStore {
    articles: Article[] = [];
    currentArticle: Article | null = null;

    constructor() {
        makeAutoObservable(this);
        this.loadArticles();
    }

    loadArticles() {
        const storedArticles = localStorage.getItem('articles');
        if (storedArticles) {
            this.articles = JSON.parse(storedArticles);
        }
    }

    saveArticles() {
        localStorage.setItem('articles', JSON.stringify(this.articles));
    }

    addTestArticles() {
        this.articles = [
            {
                id: 1,
                title: "Путешествие по Европе: незабываемые впечатления",
                content: "Европа - континент с богатой историей и культурой. От величественных Альп до солнечных пляжей Средиземноморья, каждая страна предлагает уникальный опыт. Посетите романтический Париж, исторический Рим или живописную Прагу. Насладитесь местной кухней, архитектурой и искусством. Путешествие по Европе - это возможность погрузиться в разнообразие культур и традиций.",
                author: "Александр Меркулов",
                likes: 42,
                isLiked: false,
                dateCreated: Date.now() - 5 * 24 * 60 * 60 * 1000,
            },
            {
                id: 2,
                title: "Искусственный интеллект: революция в технологиях",
                content: "Искусственный интеллект (ИИ) стремительно меняет мир вокруг нас. От виртуальных ассистентов до автономных автомобилей, ИИ находит применение во всех сферах жизни. Разберемся, как работает ИИ, какие возможности он открывает и какие этические вопросы поднимает его развитие.",
                author: "Елена Соколова",
                likes: 78,
                isLiked: true,
                dateCreated: Date.now() - 3 * 24 * 60 * 60 * 1000,
            },
            {
                id: 3,
                title: "Здоровое питание: ключ к долголетию",
                content: "Правильное питание - основа здорового образа жизни. Узнайте, какие продукты необходимы для поддержания здоровья, как составить сбалансированный рацион и почему важно следить за своим питанием. Простые советы помогут вам изменить свои пищевые привычки и улучшить самочувствие.",
                author: "Мария Иванова",
                likes: 56,
                isLiked: false,
                dateCreated: Date.now() - 7 * 24 * 60 * 60 * 1000,
            },
            {
                id: 4,
                title: "Йога для начинающих: путь к гармонии",
                content: "Йога - древняя практика, помогающая достичь баланса тела и ума. Узнайте о базовых асанах, техниках дыхания и медитации. Регулярные занятия йогой помогут улучшить гибкость, укрепить мышцы и снизить уровень стресса. Начните свой путь к гармонии уже сегодня!",
                author: "Анна Петрова",
                likes: 34,
                isLiked: true,
                dateCreated: Date.now() - 2 * 24 * 60 * 60 * 1000,
            },
            {
                id: 5,
                title: "Криптовалюты: будущее финансов или мыльный пузырь?",
                content: "Криптовалюты вызывают горячие споры в финансовом мире. Разберемся, что такое биткоин и блокчейн, как работает майнинг и какие перспективы у цифровых денег. Обсудим риски и возможности инвестирования в криптовалюты.",
                author: "Игорь Сидоров",
                likes: 92,
                isLiked: false,
                dateCreated: Date.now() - 4 * 24 * 60 * 60 * 1000,
            },
            {
                id: 6,
                title: "Как начать бегать: советы для новичков",
                content: "Бег - отличный способ поддерживать форму и укреплять здоровье. Узнайте, как правильно начать бегать, какую обувь выбрать и как составить план тренировок. Простые советы помогут вам избежать травм и получить максимум пользы от занятий бегом.",
                author: "Дмитрий Волков",
                likes: 45,
                isLiked: true,
                dateCreated: Date.now() - 6 * 24 * 60 * 60 * 1000,
            },
            {
                id: 7,
                title: "Медитация: путь к внутреннему спокойствию",
                content: "Медитация - древняя практика, помогающая обрести душевное равновесие и снизить уровень стресса. Узнайте о различных техниках медитации, их преимуществах и о том, как включить медитацию в свою повседневную жизнь. Начните свой путь к внутреннему спокойствию уже сегодня.",
                author: "Ольга Смирнова",
                likes: 67,
                isLiked: false,
                dateCreated: Date.now() - 8 * 24 * 60 * 60 * 1000,
            },
            {
                id: 8,
                title: "Искусство фотографии: как делать впечатляющие снимки",
                content: "Фотография - это не только техника, но и искусство. Узнайте о основных правилах композиции, работе со светом и цветом. Научитесь использовать настройки камеры для достижения желаемого эффекта. Простые советы помогут вам создавать впечатляющие снимки даже на смартфон.",
                author: "Сергей Кузнецов",
                likes: 83,
                isLiked: true,
                dateCreated: Date.now() - 1 * 24 * 60 * 60 * 1000,
            },
            {
                id: 9,
                title: "Как выучить иностранный язык: эффективные методики",
                content: "Изучение иностранного языка открывает новые возможности для путешествий, работы и саморазвития. Узнайте о современных методиках изучения языков, полезных ресурсах и приложениях. Простые советы помогут вам сделать процесс обучения эффективным и увлекательным.",
                author: "Наталья Орлова",
                likes: 71,
                isLiked: false,
                dateCreated: Date.now() - 9 * 24 * 60 * 60 * 1000,
            },
            {
                id: 10,
                title: "Экологичный образ жизни: маленькие шаги к большим изменениям",
                content: "Забота об окружающей среде начинается с малого. Узнайте, как сократить использование пластика, экономить воду и электроэнергию, правильно сортировать мусор. Простые советы помогут вам сделать свою жизнь более экологичной и внести вклад в сохранение планеты.",
                author: "Екатерина Морозова",
                likes: 59,
                isLiked: true,
                dateCreated: Date.now() - 10 * 24 * 60 * 60 * 1000,
            },
            {
                id: 11,
                title: "Как начать свой бизнес: от идеи до реализации",
                content: "Создание собственного бизнеса - это вызов и возможность реализовать свои идеи. Узнайте, как разработать бизнес-план, найти финансирование и преодолеть типичные трудности начинающего предпринимателя. Советы опытных бизнесменов помогут вам избежать распространенных ошибок.",
                author: "Андрей Ковалев",
                likes: 88,
                isLiked: false,
                dateCreated: Date.now() - 11 * 24 * 60 * 60 * 1000,
            },
            {
                id: 12,
                title: "Психология отношений: как построить крепкую семью",
                content: "Крепкие отношения - основа счастливой семьи. Узнайте о психологических аспектах отношений, способах эффективной коммуникации и разрешения конфликтов. Советы психологов помогут вам укрепить связь с партнером и создать гармоничную атмосферу в семье.",
                author: "Татьяна Белова",
                likes: 76,
                isLiked: true,
                dateCreated: Date.now() - 12 * 24 * 60 * 60 * 1000,
            },
            {
                id: 13,
                title: "Искусство публичных выступлений: как преодолеть страх сцены",
                content: "Умение выступать публично - важный навык в современном мире. Узнайте, как подготовиться к выступлению, структурировать речь и удерживать внимание аудитории. Практические советы помогут вам преодолеть страх сцены и стать уверенным оратором.",
                author: "Максим Григорьев",
                likes: 62,
                isLiked: false,
                dateCreated: Date.now() - 13 * 24 * 60 * 60 * 1000,
            },
            {
                id: 14,
                title: "Как улучшить память: эффективные техники запоминания",
                content: "Хорошая память - ключ к успеху в учебе и работе. Узнайте о различных техниках запоминания, таких как метод Лоци и мнемонические приемы. Простые упражнения помогут вам улучшить концентрацию и развить способность быстро усваивать новую информацию.",
                author: "Алексей Новиков",
                likes: 54,
                isLiked: true,
                dateCreated: Date.now() - 14 * 24 * 60 * 60 * 1000,
            },
            {
                id: 15,
                title: "Путешествия в одиночку: преимущества и советы",
                content: "Путешествия в одиночку - это возможность познать себя и мир вокруг. Узнайте о преимуществах соло-путешествий, как планировать маршрут и обеспечить свою безопасность. Советы опытных путешественников помогут вам сделать ваше приключение незабываемым.",
                author: "Юлия Соловьева",
                likes: 81,
                isLiked: false,
                dateCreated: Date.now() - 15 * 24 * 60 * 60 * 1000,
            }];
        this.saveArticles();
    }

    createArticle(title: string, content: string, author: string, imageUrl?: string) {
        const newArticle: Article = {
            id: Date.now(),
            title,
            content,
            author,
            likes: 0,
            isLiked: false,
            dateCreated: Date.now(),
            imageUrl: imageUrl ?? null
        };
        this.articles.push(newArticle);
        this.currentArticle = newArticle;
        this.saveArticles();
    }

    updateArticle(id: number, title: string, content: string, author: string, imageUrl?: string) {
        const article = this.articles.find(a => a.id === id);
        if (article) {
            article.title = title;
            article.content = content;
            article.author = author;

            if (imageUrl) {
                article.imageUrl = imageUrl;
            }

            this.currentArticle = article;
            this.saveArticles();
        }
    }

    toggleLike(id: number) {
        const article = this.articles.find(a => a.id === id);
        if (article) {
            article.isLiked = !article.isLiked;
            article.likes += article.isLiked ? 1 : -1;
            this.saveArticles();
        }
    }

    setCurrentArticle(id: number | null) {
        this.currentArticle = id ? this.articles.find(a => a.id === id) || null : null;
    }

    removeArticle(id: number) {
        this.articles = this.articles.filter(article => article.id !== id);
        this.saveArticles();
    }
}

export const articleStore = new ArticleStore();
